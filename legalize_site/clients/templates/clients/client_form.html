{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
  <h1>{{ title }}</h1>
  <hr>
  <form method="post">
    {% csrf_token %}
    <div class="row">
      {% for field in form %}
        <div class="col-md-6 mb-3">
          <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>

          {% if field.name in "legal_basis_end_date,submission_date,fingerprints_date" %}
            <div class="input-group" id="{{ field.id_for_label }}_picker">
              {{ field }}
              <span class="input-group-text" data-toggle>
                <i class="fas fa-calendar-alt"></i>
              </span>
            </div>
          {% else %}
            {{ field }}
          {% endif %}

          {% if field.errors %}
            <div class="invalid-feedback d-block">
              {{ field.errors|first }}
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
    <button type="submit" class="btn btn-primary mt-3">Сохранить</button>
    <a href="{{ client.get_absolute_url|default_if_none:request.META.HTTP_REFERER|default_if_none:'clients:client_list' }}" class="btn btn-secondary mt-3">Отмена</a>
  </form>
{% endblock %}

{% block extra_js %}
  {{ block.super }}
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        flatpickr("#id_legal_basis_end_date_picker", { wrap: true, dateFormat: "d.m.Y", allowInput: true });
        flatpickr("#id_submission_date_picker", { wrap: true, dateFormat: "d.m.Y", allowInput: true });
        flatpickr("#id_fingerprints_date_picker", { wrap: true, dateFormat: "d.m.Y", allowInput: true });
    });
  </script>
{% endblock %}