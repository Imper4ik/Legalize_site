{% extends "base.html" %}

{% block title %}Активные напоминания{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Активные напоминания</h1>
    <a href="{% url 'run_create_reminders' %}" class="btn btn-primary">
      <i class="bi bi-arrow-clockwise"></i> Проверить и создать напоминания
    </a>
  </div>

  <p class="text-muted">Список предстоящих дат окончания документов и оплат.</p>

  <div class="list-group">
    {% for reminder in reminders %}
      <div class="list-group-item list-group-item-action">
        <div class="d-flex w-100 justify-content-between">
          <div>
            <a href="{% url 'client_detail' reminder.client.pk %}" class="text-decoration-none text-dark">
              <h5 class="mb-1 d-inline">{{ reminder.title }}</h5>
            </a>
            <form action="{% url 'delete_reminder' reminder.id %}" method="post" class="d-inline" onsubmit="return confirm('Вы уверены, что хотите удалить это напоминание?');">
                {% csrf_token %}
                <button type="submit" class="btn btn-link btn-sm p-0 text-danger" title="Удалить напоминание">
                    <i class="bi bi-trash"></i>
                </button>
            </form>
          </div>
          <small class="text-danger">
            <strong>До: {{ reminder.due_date|date:"d.m.Y" }}</strong>
          </small>
        </div>
        <p class="mb-1">
          <strong>Клиент:</strong> {{ reminder.client.first_name }} {{ reminder.client.last_name }}
        </p>
        {% if reminder.notes %}
          <small class="text-muted">{{ reminder.notes }}</small>
        {% endif %}
      </div>
    {% empty %}
      <div class="alert alert-success">Активных напоминаний нет.</div>
    {% endfor %}
  </div>
{% endblock %}