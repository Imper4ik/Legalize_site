{% extends "base.html" %}

{% block title %}Активные напоминания{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Активные напоминания</h1>
    {# --- ИСПРАВЛЕНО ЗДЕСЬ --- #}
    <a href="{% url 'clients:create_reminders' %}" class="btn btn-primary">
      Проверить и создать напоминания
    </a>
  </div>

  {% if reminders %}
    <div class="list-group">
      {% for reminder in reminders %}
        <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
          <div>
            <h5 class="mb-1">
              <a href="{% url 'clients:client_detail' reminder.client.pk %}">{{ reminder.client }}</a>
            </h5>
            <p class="mb-1">{{ reminder.title }}</p>
            <small class="text-danger">Срок: {{ reminder.due_date|date:"d.m.Y" }}</small>
          </div>
          <form action="{% url 'clients:delete_reminder' reminder.id %}" method="post" onsubmit="return confirm('Вы уверены, что хотите удалить это напоминание?');">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline-danger btn-sm" title="Удалить">
              <i class="bi bi-trash"></i>
            </button>
          </form>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-success">
      <h4 class="alert-heading">Всё в порядке!</h4>
      <p>Активных напоминаний на ближайшее время нет.</p>
      <hr>
      <p class="mb-0">Вы можете запустить проверку вручную, чтобы создать напоминания для клиентов, у которых скоро заканчиваются документы.</p>
    </div>
  {% endif %}

{% endblock %}