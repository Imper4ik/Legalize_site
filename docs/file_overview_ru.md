# Обзор файлов Legalize Site

Документ описывает назначение файлов и каталогов проекта. Разделы сгруппированы по
расположению в репозитории и помогают быстрее ориентироваться в кодовой базе.

## Корень репозитория
- `build.sh` — сборка контейнера: установка зависимостей, компиляция переводов и
  сборка статических файлов через `collectstatic`.
- `start.sh` — сценарий запуска: прогон миграций, попытка компиляции переводов,
  автоматическое создание суперпользователя и запуск Gunicorn.
- `manage.py` — стандартная точка входа Django CLI с загрузкой переменных
  окружения через `legalize_site.env`.
- `requirements.txt` — список Python-зависимостей приложения.
- `nixpacks.toml` и `render.yaml` — конфигурация деплоя (Nixpacks и Render).
- `docs/` — вспомогательная документация по процессам и инфраструктуре.
- `locale/`, `static/`, `templates/` — каталоги локализации, статических
  ресурсов и общих шаблонов (например, страницы логина).
- `clients/` и `submissions/` — основные бизнес-приложения Django.
- `legalize_site/` — конфигурация проекта и общие утилиты.

## Django-проект `legalize_site`
- `asgi.py` / `wsgi.py` — точки входа ASGI и WSGI для сервера приложений.
- `settings.py` — базовые настройки Django: базы данных, локализация,
  подключение приложений, e-mail-бэкенды и пути к статике/медиа.
- `urls.py` — корневой роутер, подключающий маршруты приложений `clients` и
  `submissions`, а также страницы аутентификации.
- `env.py` — функция `load_env` для загрузки переменных окружения из `.env` при
  локальной разработке.
- `mail.py` — безопасный SMTP-бэкенд, который при ошибке доставки падает в
  консольный бэкенд, чтобы письма не терялись на стендах.
- `checks.py` — кастомные системные проверки Django, валидирующие конфигурацию
  e-mail (API-ключи, пароль SMTP и домен отправителя).
- `templatetags/` — общие теги шаблонов проекта.
- `utils/http.py` — утилита `request_is_ajax` для определения, ожидает ли
  запрос JSON-ответ.
- `utils/i18n.py` — функции для компиляции `.po` файлов в `.mo` без внешнего
  `msgfmt`, что обеспечивает доступность переводов в минимальных окружениях.
- `tests/` — юнит-тесты инфраструктурных частей (`checks`, теги шаблонов).

## Приложение `clients`
- `apps.py` — конфигурация приложения.
- `admin.py` — регистрация моделей клиентов, документов, платежей и напоминаний
  в административной панели.
- `constants.py` — перечисления типов документов и стандартные чек-листы.
- `forms.py` — формы для клиентов, документов, требований к документам,
  платежей и калькулятора средств.
- `models.py` — модели клиентов, документов, требований к документам, платежей и
  напоминаний, плюс вспомогательные функции для чек-листов.
- `signals.py` — автоматическая установка пароля для нового пользователя клиента
  и расчёт сроков напоминаний.
- `urls.py` — маршруты личного кабинета (сайдбар клиент/сотрудник, список
  клиентов, загрузка документов и т.п.).
- `services/calculator.py` — расчёт средств на проживание/обучение и перевод
  валют для формы калькулятора.
- `services/notifications.py` — отправка e-mail с напоминаниями об истёкших или
  недостающих документах.
- `services/pricing.py` — константы и утилиты для подсчёта стоимости услуг.
- `services/responses.py` — вспомогательный класс `ResponseHelper` для
  формирований JSON-ответов и предотвращения кеширования.
- `services/wezwanie_parser.py` — парсинг PDF-файлов Wezwanie: извлечение номера
  дела и даты отпечатков.
- `templates/` — страницы списка и профиля клиента, формы загрузки документов,
  чек-листы и e-mail шаблоны уведомлений.
- `templatetags/` — фильтры форматирования, теги для статусов документов,
  форматирования форм и отображения клиента.
- `management/commands/update_reminders.py` — команда для обновления статуса
  напоминаний по срокам.
- `views/base.py` — миксин/декоратор доступа только для сотрудников.
- `views/clients.py` — CRUD для клиентов, дашборд и логика показа чек-листов.
- `views/documents.py` — загрузка/удаление документов клиента и выдача ссылок.
- `views/payments.py` — создание и смена статусов платежей, отображение
  истории оплат клиента.
- `views/reminders.py` — интерфейс для отслеживания напоминаний по срокам.
- `tests.py` и `test_calculator_service.py` — наборы тестов приложения.

## Приложение `submissions`
- `apps.py` — конфигурация приложения.
- `admin.py` — регистрация моделей оснований и связанных документов в админке.
- `models.py` — модель основания подачи (`Submission`) со статусами и слугом, а
  также связанные документы с файлами и статусами проверки.
- `forms.py` — формы для создания/редактирования оснований и документов.
- `urls.py` — маршруты CRUD интерфейса и API для оснований и документов.
- `views.py` — HTML-страницы списка, деталей и форм, а также JSON API для
  оснований и документов.
- `templates/` — формы и страницы деталей оснований и их документов.

## Шаблоны и статические файлы
- `templates/` (в корне) — общие шаблоны, например страницы входа через
  `account/login.html` и макеты сайта.
- `static/` — статичные ресурсы (CSS/JS/изображения) для рендеринга страниц.
- `locale/` — каталоги переводов Django (`.po`/`.mo`) для поддерживаемых языков.
